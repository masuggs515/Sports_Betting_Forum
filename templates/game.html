{% extends 'base.html' %}
{% block title %} {{game.team_one}} vs. {{game.team_two}} {% endblock %}

{% block content %}
<div id="comment-error" class="container"></div>
<h2 class="mt-2 text-center text-white">{{game.team_one}} vs. {{game.team_two}}</h2>
<div class="container my-5">
    <div class="container d-flex">
        <div class="container row d-flex text-center justify-content-center">
            <div class="col-6 bg-dark border border-1 border-secondary p-1">
                <div><span class="text-white pb-1 px-3"> <b>Teams</b></span>
                </div>
            </div>
            <div class="col-3 bg-dark border border-1 border-secondary p-1">
                <div><span class="text-white pb-1 px-3"> <b>Spread</b></span></div>
            </div>
            <div class="col-6 bg-dark border border-1 border-secondary p-3">
                <div><span
                        class="bg-secondary text-white py-1 px-3 border border-1 border-white rounded-3">{{game.team_one}}</span>
                </div>
            </div>
            <div class="col-3 bg-dark border border-1 border-secondary p-3">
                <div><span
                        class="bg-secondary text-white py-1 px-3 border border-1 border-white rounded-3">{{game.team_one_odds}}</span>
                </div>
            </div>
            <div class="col-6 bg-dark border border-1 border-secondary p-3">
                <div><span
                        class="bg-secondary text-white py-1 px-3 border border-1 border-white rounded-3">{{game.team_two}}</span>
                </div>
            </div>
            <div class="col-3 bg-dark border border-1 border-secondary p-3">
                <div><span
                        class="bg-secondary text-white py-1 px-3 border border-1 border-white rounded-3">{{game.team_two_odds}}</span>
                </div>
            </div>
        </div>
    </div>

</div>

<section>
    <div class="container">
        <div class="row">
            <div class="text-white col-sm-5 col-md-6 col-12 pb-4">
                <h1>Comments</h1>
                <div id="comment-section">
                    {% if comments %}
                    {% for comment in comments %}
                    <div id="{{comment.id}}"
                        class="bg-dark border border-1 border-white rounded-3 mt-4 px-3 pt-2 text-justify float-left">
                        <img src={{comment.user.image_url}} alt="" class="rounded-circle" width="35" height="35">
                        <h4 class="d-inline mx-2"><a class="text-decoration-none text-white"
                                href="/user/{{comment.user.id}}">{{comment.user.username}}</a></h4>
                        <span class="float-end"><small>{{comment.timestamp.strftime("%d %B %Y %I:%M
                                %p")}}</small></span>
                        
                        {% for like in comment.like if like.user_id == g.user.id%}
                        
                        <span class="pt-2"><i class="likes bg-dark text-white float-end fas fa-thumbs-up me-2"></i></span>
                        {% else %}
                        <span class="pt-2"><i
                                class="likes bg-dark text-white float-end far fa-thumbs-up me-2"></i></span>
                        {% endfor %}
                        {% if comment.like | length > 0 %}
                        <span id="like_count" class="float-end me-2"><small>{{comment.like | length}} likes</small></span>
                        {% endif %}
                        {% if comment.user.id == g.user.id %}
                        <button id="delete-comment" data-="{{comment.id}}"
                            class="float-end btn btn-sm btn-outline-light me-2">Delete
                            comment <i class="fa fa-trash"></i></button>
                        {% endif %}
                        <br>
                        <p class="mx-4 mt-2">{{comment.text}}</p>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div id="no-comments" class="container">
                        <h4 class="mt-3 text-center text-white">No comments yet, Get the conversation started!</h4>
                    </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-lg-4 col-md-5 col-sm-4 offset-md-1 offset-sm-1 col-12 mt-4">
                <form id="comment-form" method="POST">
                    <div class="form-group">
                        <h4 class="text-white">Leave a comment</h4>

                        {% for field in form if field.widget.input_type != 'hidden' %}
                        {% for error in field.errors %}
                        <span class="text-danger">{{ error }}</span>
                        {% endfor %}
                        {{ field( id=field.label.text, cols="30", rows="5", class="my-2 form-control bg-dark
                        text-white") }}
                        {% endfor %}

                        <div class="form-group"> <button type="submit" id="post" class="btn btn-dark">Post
                                Comment</button> </div>
                </form>
            </div>
        </div>
    </div>
</section>
{% endblock %}